# 高考组卷功能配置指南

该功能基于 Multi-Agent 架构，由调度、出题、质检、模拟考生、评分、难度计算、组装共七个 Agent 协作完成。首次使用需完成以下三步配置。

## 一、导入历年真题库

系统使用 [GAOKAO-Bench](https://github.com/OpenLMLab/GAOKAO-Bench) 开源数据集作为 Few-shot 样本来源，需先在管理员后台「真题库管理」页面完成导入，支持三种方式：

| 方式                   | 适用场景                                     |
| ---------------------- | -------------------------------------------- |
| **一键从 GitHub 导入** | 服务器可访问外网，系统自动拉取并尝试国内镜像 |
| **服务器路径导入**     | 已手动将数据放在服务器指定目录               |
| **文件上传导入**       | 手动上传 GAOKAO-Bench 格式的 `.json` 文件    |

> 导入前可在「预检」页面测试 Embedding API 是否可用。

## 二、授权教师

高考组卷功能需管理员单独授权。进入管理员后台「权限管理」页面，找到对应教师点击授权，可设置月度 Token 配额（不填则无限制）。

## 三、Agent 配置

在管理员后台「系统配置」→「仿高考组卷 Agent 配置」中可调整以下参数：

| 配置项                  | 默认值            | 说明                                                                     |
| ----------------------- | ----------------- | ------------------------------------------------------------------------ |
| SolveAgent 试做次数 K   | `5`               | 每道题并行模拟作答次数，越多难度评估越准确，但 Token 消耗成倍增加        |
| 单题最大重试次数        | `3`               | 质检失败或难度不达标时的最大重试次数（质检与难度共用计数器）             |
| 并发窗口大小            | `8`               | 同时处理的题目数，调高可加速，但会增加 API 并发压力，建议按 API 等级调整 |
| Few-shot 样本数量       | `3`               | 每道题注入的历年同位置真题样本数量，增大可提升仿真度                     |
| 单题平均 Token 消耗估算 | `15000`           | 配额预估接口的单题 Token 基准值，含生成、质检、K×试做评分                |
| 热点缓存 TTL            | `21600`（6 小时） | HotspotAgent 结果缓存时间，启用热点模式时生效                            |
| 热点时间范围            | `30` 天           | 抓取最近 N 天内的热点新闻用于出题素材                                    |

**独立 LLM 配置（可选）**：在「组卷 Agent 独立 LLM 配置」中，可为每个 Agent 单独指定 API Key / Base URL / 模型，留空则自动回退到全局 LLM 配置。

| Agent                     | 职责                               | 建议                                                      |
| ------------------------- | ---------------------------------- | --------------------------------------------------------- |
| DispatchAgent（调度）     | 任务分发、RAG 知识检索             | 可使用轻量模型                                            |
| QuestionAgent（出题）     | 依据真题样本生成新题               | 建议使用能力较强的模型                                    |
| QualityCheckAgent（质检） | 审核题目逻辑、选项、答案一致性     | 建议使用推理能力强的模型                                  |
| SolveAgent（模拟考生）    | 模拟不同水平学生作答，用于难度评估 | 建议用弱一档模型降低成本；支持「多模型并行配置」JSON 数组 |
| GradeAgent（评分）        | 判断模拟作答是否正确               | 建议与出题模型不同，避免出题偏见影响评分                  |
| HotspotAgent（热点）      | 从新闻提取知识热点融入出题素材     | 启用「结合时事热点」选项时生效                            |
