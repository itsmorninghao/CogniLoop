"""ä»¿é«˜è€ƒç»„å· Multi-Agent æ‰€æœ‰ Prompt æ¨¡æ¿"""

# ---------------------------------------------------------------------------
# DispatchAgent â€”â€” çŸ¥è¯†ç‚¹æ¨æ–­
# ---------------------------------------------------------------------------

DISPATCH_KNOWLEDGE_POINT_SYSTEM = (
    "ä½ æ˜¯ä¸€ä½é«˜è€ƒå‘½é¢˜ç ”ç©¶ä¸“å®¶ï¼Œæ“…é•¿åˆ†æå†å¹´çœŸé¢˜çš„å‘½é¢˜è§„å¾‹ã€‚"
)

DISPATCH_KNOWLEDGE_POINT_USER = """ä»¥ä¸‹æ˜¯ã€{subject}ã€‘ç¬¬{position_index}é¢˜å†å¹´çœŸé¢˜ï¼Œè¯·å½’çº³è¯¥ä½ç½®æœ€å¸¸è€ƒå¯Ÿçš„ 1 ä¸ªæ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼ˆ10å­—ä»¥å†…ï¼Œç›´æ¥è¾“å‡ºçŸ¥è¯†ç‚¹åç§°ï¼Œä¸è¦æœ‰å…¶ä»–è¯´æ˜ï¼‰ï¼š

{examples_text}"""


# ---------------------------------------------------------------------------
# QuestionAgent â€”â€” é¢˜ç›®ç”Ÿæˆ
# ---------------------------------------------------------------------------

QUESTION_AGENT_SYSTEM = """ä½ æ˜¯ä¸€ä½èµ„æ·±é«˜è€ƒå‘½é¢˜ä¸“å®¶ã€‚ä½ æ­£åœ¨ä¸ºä¸€å¥—æ¨¡æ‹Ÿè¯•å·å‡ºã€{position_label}ã€‘ï¼ˆ{question_type_label}ï¼‰ã€‚

ä»¥ä¸‹æ˜¯å†å¹´é«˜è€ƒè¯¥ä½ç½®åŒç±»å‹é¢˜ç›®ï¼Œä¾›ä½ ä»¿ç…§é£æ ¼å’Œéš¾åº¦ï¼š

{same_position_examples}

å‡ºé¢˜è¦æ±‚ï¼š
1. ä»¿ç…§ä¸Šè¿°å†å¹´åŒä½ç½®é¢˜ç›®çš„é£æ ¼ï¼ˆé¢˜å¹²é•¿åº¦ã€è¡¨è¿°ä¹ æƒ¯ã€é€‰é¡¹æ•°é‡ä¸æ’å¸ƒï¼‰
2. è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹ä¸ºã€{knowledge_point}ã€‘ï¼Œéš¾åº¦ä¸ºã€{difficulty_label}ã€‘
3. ä¸å¾—ä¸ä¸Šè¿°å‚è€ƒé¢˜é¢˜å¹²é›·åŒï¼Œé¡»æ¢æƒ…å¢ƒ/æ¢æ•°å­—/æ¢ææ–™ï¼Œä½“ç°è¯¥ä½ç½®çš„å‘½é¢˜è§„å¾‹è€ŒéæŠ„è¢­
4. è‹¥æä¾›äº†çƒ­ç‚¹ææ–™ï¼Œæƒ…å¢ƒåº”å›´ç»•çƒ­ç‚¹å±•å¼€
5. ç­”æ¡ˆå¿…é¡»å”¯ä¸€ä¸”æ— äº‰è®®
6. æä¾›è¯¦ç»†è§£æï¼›ç®€ç­”é¢˜é¡»åˆ—å‡ºè¯„åˆ†è¦ç‚¹"""

QUESTION_AGENT_USER_RAG = """è¯¾ç¨‹çŸ¥è¯†åº“ç›¸å…³å†…å®¹ï¼ˆè¯·åœ¨æ­¤èŒƒå›´å†…å‡ºé¢˜ï¼‰ï¼š
{rag_context}

çƒ­ç‚¹ææ–™ï¼ˆå¦‚æœ‰ï¼‰ï¼š
{hotspot_material}

é¢å¤–è¦æ±‚ï¼š
{extra_instructions}

{retry_section}

è¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹ Markdown æ ¼å¼è¾“å‡ºï¼Œä¸è¦æœ‰ä»»ä½•å…¶ä»–è¯´æ˜ï¼š

## é¢˜ç›® {position_index} [{question_type}]

**é¢˜ç›®å†…å®¹**ï¼š{{é¢˜å¹²}}

**é€‰é¡¹ A**ï¼š{{A}}
**é€‰é¡¹ B**ï¼š{{B}}
**é€‰é¡¹ C**ï¼š{{C}}
**é€‰é¡¹ D**ï¼š{{D}}

**æ­£ç¡®ç­”æ¡ˆ**ï¼š{{ç­”æ¡ˆå­—æ¯ï¼Œå•é€‰ä¸€ä¸ªå­—æ¯å¦‚ Bï¼Œå¤šé€‰å¤šä¸ªå­—æ¯å¦‚ AB}}

**è§£æ**ï¼š{{è¯¦ç»†è§£æ}}"""

QUESTION_AGENT_USER_NO_RAG = """ï¼ˆæ— è¯¾ç¨‹çŸ¥è¯†åº“ï¼Œè¯·æŒ‰é«˜è€ƒæ ‡å‡†å’Œå†å¹´çœŸé¢˜é£æ ¼å‡ºé¢˜ï¼‰

çƒ­ç‚¹ææ–™ï¼ˆå¦‚æœ‰ï¼‰ï¼š
{hotspot_material}

é¢å¤–è¦æ±‚ï¼š
{extra_instructions}

{retry_section}

è¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹ Markdown æ ¼å¼è¾“å‡ºï¼Œä¸è¦æœ‰ä»»ä½•å…¶ä»–è¯´æ˜ï¼š

## é¢˜ç›® {position_index} [{question_type}]

**é¢˜ç›®å†…å®¹**ï¼š{{é¢˜å¹²}}

**é€‰é¡¹ A**ï¼š{{A}}
**é€‰é¡¹ B**ï¼š{{B}}
**é€‰é¡¹ C**ï¼š{{C}}
**é€‰é¡¹ D**ï¼š{{D}}

**æ­£ç¡®ç­”æ¡ˆ**ï¼š{{ç­”æ¡ˆå­—æ¯ï¼Œå•é€‰ä¸€ä¸ªå­—æ¯å¦‚ Bï¼Œå¤šé€‰å¤šä¸ªå­—æ¯å¦‚ AB}}

**è§£æ**ï¼š{{è¯¦ç»†è§£æ}}"""

# å¡«ç©ºé¢˜ä¸“ç”¨æ ¼å¼æ¨¡æ¿
QUESTION_AGENT_USER_FILL_BLANK_RAG = """è¯¾ç¨‹çŸ¥è¯†åº“ç›¸å…³å†…å®¹ï¼ˆè¯·åœ¨æ­¤èŒƒå›´å†…å‡ºé¢˜ï¼‰ï¼š
{rag_context}

çƒ­ç‚¹ææ–™ï¼ˆå¦‚æœ‰ï¼‰ï¼š
{hotspot_material}

é¢å¤–è¦æ±‚ï¼š
{extra_instructions}

{retry_section}

è¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹ Markdown æ ¼å¼è¾“å‡ºï¼Œä¸è¦æœ‰ä»»ä½•å…¶ä»–è¯´æ˜ï¼š

## é¢˜ç›® {position_index} [{question_type}]

**é¢˜ç›®å†…å®¹**ï¼š{{å«æ¨ªçº¿ï¼ˆ___ï¼‰ç©ºæ ¼çš„é¢˜å¹²}}

**æ­£ç¡®ç­”æ¡ˆ**ï¼š{{ç®€æ´çš„å¡«ç©ºç­”æ¡ˆæ–‡å­—ï¼Œå¤šç©ºç”¨"ï¼›"åˆ†éš”}}

**è§£æ**ï¼š{{è¯¦ç»†è§£æ}}"""

QUESTION_AGENT_USER_FILL_BLANK_NO_RAG = """ï¼ˆæ— è¯¾ç¨‹çŸ¥è¯†åº“ï¼Œè¯·æŒ‰é«˜è€ƒæ ‡å‡†å’Œå†å¹´çœŸé¢˜é£æ ¼å‡ºé¢˜ï¼‰

çƒ­ç‚¹ææ–™ï¼ˆå¦‚æœ‰ï¼‰ï¼š
{hotspot_material}

é¢å¤–è¦æ±‚ï¼š
{extra_instructions}

{retry_section}

è¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹ Markdown æ ¼å¼è¾“å‡ºï¼Œä¸è¦æœ‰ä»»ä½•å…¶ä»–è¯´æ˜ï¼š

## é¢˜ç›® {position_index} [{question_type}]

**é¢˜ç›®å†…å®¹**ï¼š{{å«æ¨ªçº¿ï¼ˆ___ï¼‰ç©ºæ ¼çš„é¢˜å¹²}}

**æ­£ç¡®ç­”æ¡ˆ**ï¼š{{ç®€æ´çš„å¡«ç©ºç­”æ¡ˆæ–‡å­—ï¼Œå¤šç©ºç”¨"ï¼›"åˆ†éš”}}

**è§£æ**ï¼š{{è¯¦ç»†è§£æ}}"""

QUESTION_AGENT_USER_SHORT_ANSWER = """ï¼ˆ{rag_or_norag}ï¼‰

çƒ­ç‚¹ææ–™ï¼ˆå¦‚æœ‰ï¼‰ï¼š
{hotspot_material}

é¢å¤–è¦æ±‚ï¼š
{extra_instructions}

{retry_section}

è¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹ Markdown æ ¼å¼è¾“å‡ºï¼š

## é¢˜ç›® {position_index} [{question_type}]

**é¢˜ç›®å†…å®¹**ï¼š{{é¢˜å¹²ï¼ˆå«ææ–™ï¼‰}}

**å‚è€ƒç­”æ¡ˆ**ï¼š{{åˆ†ç‚¹ä½œç­”çš„å‚è€ƒç­”æ¡ˆ}}

**è¯„åˆ†è¦ç‚¹**ï¼š
- {{è¦ç‚¹1}}ï¼ˆXåˆ†ï¼‰
- {{è¦ç‚¹2}}ï¼ˆXåˆ†ï¼‰

**è§£æ**ï¼š{{å‘½é¢˜æ„å›¾åŠç­”é¢˜æ€è·¯}}"""

RETRY_SECTION_TEMPLATE = """âš ï¸ ä¸Šæ¬¡ç”Ÿæˆè¢«æ‹’ç»ï¼ŒåŸå› å¦‚ä¸‹ï¼Œè¯·é’ˆå¯¹æ€§æ”¹è¿›ï¼š
{retry_feedback}"""


# ---------------------------------------------------------------------------
# QualityCheckAgent â€”â€” è´¨é‡å®¡æ ¸
# ---------------------------------------------------------------------------

QUALITY_CHECK_SYSTEM = """ä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„é«˜è€ƒå‘½é¢˜å®¡æ ¸ä¸“å®¶ã€‚è¯·å¯¹ä»¥ä¸‹é¢˜ç›®è¿›è¡Œè´¨é‡å®¡æ ¸ï¼Œåˆ¤æ–­æ˜¯å¦ç¬¦åˆåŸºæœ¬å‡ºé¢˜è§„èŒƒã€‚

ã€é‡è¦åŸåˆ™ã€‘ï¼šå¯¹äºæ”¿æ²»ã€å†å²ã€åœ°ç†ç­‰äººæ–‡å­¦ç§‘ï¼Œé€‰æ‹©é¢˜æœ¬èº«å­˜åœ¨ä¸€å®šä¸»è§‚æ€§ï¼Œåªè¦æœ‰ä¸€ä¸ªé€‰é¡¹æ˜¯"æœ€ä½³ç­”æ¡ˆ"å³å¯é€šè¿‡å®¡æ ¸ï¼Œä¸è¦å› ä¸ºå…¶ä»–é€‰é¡¹"ä¹Ÿæœ‰ä¸€å®šé“ç†"è€Œæ‹’ç»ã€‚

å®¡æ ¸æ ‡å‡†ï¼ˆåªæ‹’ç»ä»¥ä¸‹æƒ…å½¢ï¼Œå…¶ä½™è¯·é€šè¿‡ï¼‰ï¼š
1. æ ¼å¼ç¼ºå¤±ï¼šç¼ºå°‘é¢˜å¹²ã€ç­”æ¡ˆæˆ–è§£æï¼ˆå¿…é¡»æ‹’ç»ï¼‰
2. ç­”æ¡ˆæ˜æ˜¾é”™è¯¯ï¼šæ­£ç¡®ç­”æ¡ˆä¸é¢˜å¹²æè¿°çš„æ ¸å¿ƒäº‹å®å­˜åœ¨ç›´æ¥çŸ›ç›¾ï¼ˆä¸æ˜¯"è§£æè§’åº¦ä¸åŒ"ï¼Œè€Œæ˜¯ç­”æ¡ˆå†™é”™äº†å­—æ¯æˆ–æŒ‡å‘é”™è¯¯é€‰é¡¹ï¼‰
3. é¢˜å¹²æœ¬èº«å­˜åœ¨ä¸¥é‡æ­§ä¹‰ï¼šé¢˜å¹²æè¿°è‡ªç›¸çŸ›ç›¾ï¼Œæ— æ³•ç†è§£
4. ç­”æ¡ˆå®Œå…¨ç©ºç™½æˆ–ä¸ºæ— æ„ä¹‰å†…å®¹

ã€ä¸åº”æ‹’ç»çš„æƒ…å½¢ã€‘ï¼š
- å…¶ä»–é€‰é¡¹"ä¹Ÿæœ‰ä¸€å®šåˆç†æ€§"ä½†æ‰€é€‰ç­”æ¡ˆæ˜¯æœ€ä¼˜é€‰é¡¹
- å¯¹çŸ¥è¯†ç‚¹çš„è¯ é‡Šè§’åº¦ä¸åŒ
- è®¡ç®—æ­¥éª¤ç•¥æœ‰ç®€åŒ–ä½†ç»“è®ºæ­£ç¡®
- è§£ææ–‡å­—å†—é•¿æˆ–æœ‰å¤šä½™è¡¨è¿°

è‹¥é€šè¿‡ï¼Œè¾“å‡ºï¼š{"passed": true, "rejection_reasons": []}
è‹¥ä¸é€šè¿‡ï¼Œè¾“å‡ºï¼š{"passed": false, "rejection_reasons": ["åŸå› 1ï¼ˆå¿…é¡»æ˜¯ä¸Šè¿°æ˜ç¡®æ‹’ç»æƒ…å½¢ï¼‰"]}
åªè¾“å‡º JSONï¼Œä¸è¦æœ‰å…¶ä»–è¯´æ˜ã€‚"""

QUALITY_CHECK_USER = """å¾…å®¡æ ¸é¢˜ç›®ï¼š

{question_markdown}"""


# ---------------------------------------------------------------------------
# SolveAgent â€”â€” æ¨¡æ‹Ÿè€ƒç”Ÿä½œç­”
# ---------------------------------------------------------------------------

SOLVE_AGENT_SYSTEM = """ä½ æ˜¯ä¸€åçŸ¥è¯†æŒæ¡ä¸ç¨³å®šçš„æ™®é€šé«˜ä¸­ç”Ÿï¼Œæ­£åœ¨å‚åŠ é«˜è€ƒæ¨¡æ‹Ÿè€ƒè¯•ã€‚
ä½ çš„ç‰¹ç‚¹ï¼š
- åŸºç¡€çŸ¥è¯†è¿˜å¯ä»¥ï¼Œä½†é‡åˆ°å¤æ‚æ¨ç†å®¹æ˜“å‡ºé”™
- æœ‰æ—¶å€™ä¼šè¢«å¹²æ‰°é¡¹è¿·æƒ‘ï¼Œé€‰é”™ç­”æ¡ˆ
- ä¸æ˜¯æ¯æ¬¡éƒ½èƒ½ç­”å¯¹ï¼Œæ­£ç¡®ç‡å¤§çº¦åœ¨50%-70%
- é‡åˆ°ä¸ç¡®å®šçš„é¢˜ç›®ï¼Œå¾€å¾€å‡­æ„Ÿè§‰é€‰ï¼Œå¯èƒ½é€‰é”™
è¯·ç”¨è¿™ç§æ°´å¹³ä½œç­”ï¼Œä¸è¦æ¯æ¬¡éƒ½ç»™å‡ºå®Œå…¨æ­£ç¡®çš„ç­”æ¡ˆã€‚"""

SOLVE_AGENT_USER_CHOICE = """è¯·å›ç­”ä»¥ä¸‹é€‰æ‹©é¢˜ï¼š

{question_text}

é€‰é¡¹ï¼š
{options_text}

è¯·ç”¨æ™®é€šå­¦ç”Ÿçš„æ€è·¯ç®€å•æ€è€ƒï¼ˆä¸éœ€è¦å…¨é¢åˆ†æï¼‰ï¼Œæœ€åä¸€è¡Œå†™ï¼šæˆ‘é€‰[å­—æ¯]
ï¼ˆæ³¨æ„ï¼šä½ ä¸æ˜¯å­¦éœ¸ï¼Œé‡åˆ°ä¸ç¡®å®šçš„é¢˜ç›®ï¼Œå‡­æ„Ÿè§‰é€‰ä¸€ä¸ªå°±å¥½ï¼‰"""

SOLVE_AGENT_USER_FILL_BLANK = """è¯·å›ç­”ä»¥ä¸‹å¡«ç©ºé¢˜ï¼ˆç›´æ¥å†™å¡«å…¥æ¨ªçº¿çš„å†…å®¹ï¼‰ï¼š

{question_text}

ä½ çš„ç­”æ¡ˆï¼ˆåªå†™å¡«ç©ºå†…å®¹ï¼Œå¤šç©ºç”¨"ï¼›"åˆ†éš”ï¼‰ï¼š"""

SOLVE_AGENT_USER_SHORT_ANSWER = """è¯·å›ç­”ä»¥ä¸‹é¢˜ç›®ï¼š

{question_text}

ä½ çš„ç­”æ¡ˆï¼š"""


# ---------------------------------------------------------------------------
# GradeAgent â€”â€” ç­”æ¡ˆè¯„åˆ†
# ---------------------------------------------------------------------------

GRADE_AGENT_SYSTEM = """ä½ æ˜¯ä¸€ä½å…¬æ­£çš„é«˜è€ƒé˜…å·è€å¸ˆã€‚è¯·æ ¹æ®å‚è€ƒç­”æ¡ˆå’Œè¯„åˆ†è¦ç‚¹ï¼Œå¯¹å­¦ç”Ÿä½œç­”è¿›è¡Œè¯„åˆ†ã€‚
åªè¾“å‡º JSONï¼Œæ ¼å¼ï¼š{"score": 0.0 åˆ° 1.0 ä¹‹é—´çš„å°æ•°, "reasoning": "ç®€çŸ­è¯„åˆ†ç†ç”±"}"""

GRADE_AGENT_USER_SHORT_ANSWER = """é¢˜ç›®ï¼š
{question_text}

å‚è€ƒç­”æ¡ˆï¼š
{correct_answer}

è¯„åˆ†è¦ç‚¹ï¼š
{scoring_points}

å­¦ç”Ÿä½œç­”ï¼š
{student_answer}

è¯·ç»™å‡º 0.0-1.0 çš„å¾—åˆ†ï¼ˆ1.0 = æ»¡åˆ†ï¼Œ0.6 ä»¥ä¸Šè§†ä¸ºåŸºæœ¬æ­£ç¡®ï¼‰ï¼š"""


# ---------------------------------------------------------------------------
# DifficultyAgent â€”â€” éš¾åº¦è¯„ä¼°åé¦ˆ
# ---------------------------------------------------------------------------

DIFFICULTY_FEEDBACK_TEMPLATE = """é¢˜ç›®éš¾åº¦ç³»æ•°ä¸º {coefficient:.2f}ï¼ˆç›®æ ‡åŒºé—´ {target_min:.2f}-{target_max:.2f}ï¼Œ{direction}ï¼‰ã€‚
å¯èƒ½åŸå› ï¼š{reason}
å»ºè®®ï¼š{suggestion}"""

DIFFICULTY_REASONS = {
    "too_easy": {
        "reason": "çŸ¥è¯†ç‚¹è¿‡äºåŸºç¡€ï¼Œé€‰é¡¹åŒºåˆ†åº¦ä¸è¶³",
        "suggestion": "æ¢ç”¨æ›´ååƒ»çš„è€ƒç‚¹ï¼Œæˆ–åœ¨å¹²æ‰°é¡¹è®¾è®¡ä¸Šå¢åŠ è¿·æƒ‘æ€§",
    },
    "too_hard": {
        "reason": "é¢˜ç›®è¿‡äºå¤æ‚ï¼Œæ™®é€šè€ƒç”Ÿéš¾ä»¥åœ¨é™å®šæ—¶é—´å†…ä½œç­”",
        "suggestion": "ç®€åŒ–é¢˜å¹²ï¼Œå‡å°‘ææ–™é‡ï¼Œæˆ–é€‰ç”¨æ›´åŸºç¡€çš„æƒ…å¢ƒ",
    },
}


# ---------------------------------------------------------------------------
# AssembleAgent â€”â€” ç»„å·æ’ç‰ˆ
# ---------------------------------------------------------------------------

ASSEMBLE_TITLE_TEMPLATE = "{subject}ä»¿é«˜è€ƒæ¨¡æ‹Ÿå·"

ASSEMBLE_HEADER_TEMPLATE = """> ğŸ“‹ ç»„å·ä¿¡æ¯ï¼š{subject} Â· å…±{total}é¢˜ Â· ç›®æ ‡éš¾åº¦ï¼š{difficulty_label} Â· å·å‹é£æ ¼ï¼š{region}
> ğŸŒŸ å‚è€ƒé£æ ¼ï¼šè¿‘{years}å¹´{region}é«˜è€ƒçœŸé¢˜
{warning_line}"""

QUESTION_TYPE_LABELS = {
    "single_choice": "å•é€‰é¢˜",
    "multiple_choice": "å¤šé€‰é¢˜",
    "fill_blank": "å¡«ç©ºé¢˜",
    "short_answer": "ç®€ç­”é¢˜/ææ–™åˆ†æé¢˜",
}

DIFFICULTY_LABELS = {
    "easy": "ç®€å•",
    "medium": "ä¸­ç­‰",
    "hard": "å›°éš¾",
}
